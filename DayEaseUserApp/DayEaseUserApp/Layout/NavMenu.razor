@inherits LayoutComponentBase
@inject NavigationManager NavigationManager
@using DayEaseServices.Services.IServices
@inject ICartService CartService

<div class="top-bar">
    <div class="header-left">
        <button class="hamburger" @onclick="ToggleNavMenu">
            <img src="images/Cart-Logo.png" alt="Menu" class="logo-img" />
        </button>
        @* <img src="images/Day-Ease-logo-black.png" alt="DayEase Logo" class="header-logo" /> *@
    </div>

    <div class="header-right">
        <button class="cart-btn" @onclick="OpenCart">
            <i class="bi bi-cart3"></i>
            <span class="cart-text">Cart</span>
            <span class="cart-count">@CartService.CartItemCount</span>
        </button>
    </div>
</div>

<div class="sidebar-overlay @(collapseNavMenu ? "" : "show")" @onclick="ToggleNavMenu"></div>

<div class="sidebar-menu @(collapseNavMenu ? "" : "open")">
    <div class="sidebar-header">
        <img src="images/Day-Ease-logo-black.png" alt="DayEase Logo" class="sidebar-logo" />
        @* <span class="sidebar-title">DayEaseUserApp</span> *@
    </div>
    <nav>
        <NavLink class="nav-link border-bottom py-3 text-white" href="MyOrders">
            <i class="bi bi-receipt me-2"></i> MyOrders
        </NavLink>
        <NavLink class="nav-link border-bottom py-3 text-white" href="profile">
            <i class="bi bi-person me-2"></i> Profile
        </NavLink>
        <NavLink class="nav-link border-bottom py-3 text-white" href="stores">
            <i class="bi bi-shop me-2"></i> Stores
        </NavLink>
        <NavLink class="nav-link border-bottom py-3 text-white" href="support">
            <i class="bi bi-headset me-2"></i> Support
        </NavLink>
        <NavLink class="nav-link py-3 text-white" href="logout">
            <i class="bi bi-box-arrow-left me-2"></i> Logout
        </NavLink>
    </nav>
</div>

<!-- Main content area -->
<div class="content-area">
    @Body
</div>

@* @code {
    private bool collapseNavMenu = true;
    private int cartItemCount = 0; // You can bind this to your cart service

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }

    private void OpenCart()
    {
        // Navigate to cart page or open cart modal
        // NavigationManager.NavigateTo("/cart");
    }
} *@

@code {
    private bool collapseNavMenu = true;

    protected override void OnInitialized()
    {
        CartService.OnChange += StateHasChanged;
    }

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }

    private void OpenCart()
    {
        NavigationManager.NavigateTo("/cart");
    }

    public void Dispose()
    {
        CartService.OnChange -= StateHasChanged;
    }
}
